// Map database classLevel to curriculum key
export const classLevelToCurriculumKey: Record<string, string> = {
    "LIFE_CLASS": "LIFE CLASS",
    "SOL_1": "SOL 1",
    "SOL_2": "SOL 2",
    "SOL_3": "SOL 3",
};

export const curriculum = {
    "LIFE CLASS": [
        { id: 1, title: "Learning from our mistakes", description: "", url: "https://pub-71cfc9e8b30e46868845fef5a9b3555f.r2.dev/classes/LIFECLASS/1-learning-from-our-mistakes.mp4" },
        { id: 2, title: "The best deal of your life", description: "", url: "https://pub-71cfc9e8b30e46868845fef5a9b3555f.r2.dev/classes/LIFECLASS/2-the-best-deal-of-your-life.mp4" },
        { id: 3, title: "The best experience of your life", description: "", url: "https://pub-71cfc9e8b30e46868845fef5a9b3555f.r2.dev/classes/LIFECLASS/3-the-best-experience-of-your-life.mp4" },
        { id: 6, title: "Discover the secret that will transform your life", description: "", url: "https://pub-71cfc9e8b30e46868845fef5a9b3555f.r2.dev/classes/LIFECLASS/6-discover-the-secret-that-will-transform-your-life.mp4" },
        { id: 7, title: "Your decisions defines you", description: "", url: "https://pub-71cfc9e8b30e46868845fef5a9b3555f.r2.dev/classes/LIFECLASS/7-your-decisions-defines-you.mp4" },
        { id: 8, title: "Nothing less but God's best", description: "", url: "https://pub-71cfc9e8b30e46868845fef5a9b3555f.r2.dev/classes/LIFECLASS/8-nothing-less-but-gods-best.mp4" },
        { id: 9, title: "A new beginning", description: "", url: "https://pub-71cfc9e8b30e46868845fef5a9b3555f.r2.dev/classes/LIFECLASS/9-a-new-beginning.mp4" },
    ],
    "SOL 1": {
        "MODULE 1": [
            { id: 1, title: "Pastored in His Love", description: "", url: "https://pub-71cfc9e8b30e46868845fef5a9b3555f.r2.dev/classes/SOL-1/MODULE-1/1-pastored-in-his-love.mp4" },
            { id: 2, title: "Cultivating a relationship with God", description: "", url: "https://pub-71cfc9e8b30e46868845fef5a9b3555f.r2.dev/classes/SOL-1/MODULE-1/2-cultivating-a-relationship-with-god.mp4" },
            { id: 3, title: "The power of praise and worship", description: "", url: "https://pub-71cfc9e8b30e46868845fef5a9b3555f.r2.dev/classes/SOL-1/MODULE-1/3-the-power-of-praise-and-worship.mp4" },
            { id: 4, title: "Strengthened in God", description: "", url: "https://pub-71cfc9e8b30e46868845fef5a9b3555f.r2.dev/classes/SOL-1/MODULE-1/4-strengthened-in-god.mp4" },
            { id: 5, title: "Spiritual warfare", description: "", url: "https://pub-71cfc9e8b30e46868845fef5a9b3555f.r2.dev/classes/SOL-1/MODULE-1/5-spiritual-warfare.mp4" },
            { id: 6, title: "The redemptive power of the blood", description: "", url: "https://pub-71cfc9e8b30e46868845fef5a9b3555f.r2.dev/classes/SOL-1/MODULE-1/6-the-redemptive-power-of-the-blood.mp4" },
            { id: 7, title: "The Bible will transform your life", description: "", url: "https://pub-71cfc9e8b30e46868845fef5a9b3555f.r2.dev/classes/SOL-1/MODULE-1/7-the-bible-will-transform-your-life.mp4" },
            { id: 8, title: "The anointing of the Holy Spirit", description: "", url: "https://pub-71cfc9e8b30e46868845fef5a9b3555f.r2.dev/classes/SOL-1/MODULE-1/8-the-anointing-of-the-holy-spirit.mp4" },
            { id: 9, title: "The blessing of prosperity", description: "", url: "https://pub-71cfc9e8b30e46868845fef5a9b3555f.r2.dev/classes/SOL-1/MODULE-1/9-the-blessing-of-prosperity.mp4" },
            { id: 10, title: "Building the church", description: "", url: "https://pub-71cfc9e8b30e46868845fef5a9b3555f.r2.dev/classes/SOL-1/MODULE-1/10-building-the-church.mp4" }
        ],
        "MODULE 2": [
            { id: 1, title: "What is vision", description: "", url: "https://pub-71cfc9e8b30e46868845fef5a9b3555f.r2.dev/classes/SOL-1/MODULE-2/1-what-is-vision.mp4" },
            { id: 2, title: "Principles of G12", description: "", url: "https://pub-71cfc9e8b30e46868845fef5a9b3555f.r2.dev/classes/SOL-1/MODULE-2/2-principles-of-g12.mp4" },
            { id: 3, title: "A firm foundation", description: "", url: "https://pub-71cfc9e8b30e46868845fef5a9b3555f.r2.dev/classes/SOL-1/MODULE-2/3-a-firm-foundation.mp4" },
            { id: 4, title: "The vision of the government of 12", description: "", url: "https://pub-71cfc9e8b30e46868845fef5a9b3555f.r2.dev/classes/SOL-1/MODULE-2/4-the-vision-of-the-government-of-12.mp4" },
            { id: 5, title: "Forming the best team", description: "", url: "https://pub-71cfc9e8b30e46868845fef5a9b3555f.r2.dev/classes/SOL-1/MODULE-2/5-forming-the-best-team.mp4" },
            { id: 6, title: "Successful leadership", description: "", url: "https://pub-71cfc9e8b30e46868845fef5a9b3555f.r2.dev/classes/SOL-1/MODULE-2/6-successful-leadership.mp4" },
            { id: 7, title: "The art of winning", description: "", url: "https://pub-71cfc9e8b30e46868845fef5a9b3555f.r2.dev/classes/SOL-1/MODULE-2/7-the-art-of-winning.mp4" },
            { id: 8, title: "Blessing through the cell group", description: "", url: "https://pub-71cfc9e8b30e46868845fef5a9b3555f.r2.dev/classes/SOL-1/MODULE-2/8-blessing-through-the-cell-group.mp4" },
            { id: 9, title: "Ready to consolidate", description: "", url: "https://pub-71cfc9e8b30e46868845fef5a9b3555f.r2.dev/classes/SOL-1/MODULE-2/9-ready-to-consolidate.mp4" },
            { id: 10, title: "The power of the 144", description: "", url: "https://pub-71cfc9e8b30e46868845fef5a9b3555f.r2.dev/classes/SOL-1/MODULE-2/10-the-power-of-144.mp4" }
        ]
    },
    "SOL 2": {
        "MODULE 3": [
            { id: 1, title: "The present glory", description: "", url: "https://pub-71cfc9e8b30e46868845fef5a9b3555f.r2.dev/classes/SOL2/MODULE-3/1-the-present-glory.mp4" },
            { id: 2, title: "Key principles of winning", description: "", url: "https://pub-71cfc9e8b30e46868845fef5a9b3555f.r2.dev/classes/SOL2/MODULE-3/2-key-principles-of-winning.mp4" },
            { id: 3, title: "The power of evangelism", description: "", url: "https://pub-71cfc9e8b30e46868845fef5a9b3555f.r2.dev/classes/SOL2/MODULE-3/3-the-power-of-evangelism.mp4" },
            { id: 4, title: "Effective evangelism", description: "", url: "https://pub-71cfc9e8b30e46868845fef5a9b3555f.r2.dev/classes/SOL2/MODULE-3/4-effective-evangelism.mp4" },
            { id: 5, title: "The anointing to win", description: "", url: "https://pub-71cfc9e8b30e46868845fef5a9b3555f.r2.dev/classes/SOL2/MODULE-3/5-the-anointing-to-win.mp4" },
            { id: 6, title: "Compassion", description: "", url: "https://pub-71cfc9e8b30e46868845fef5a9b3555f.r2.dev/classes/SOL2/MODULE-3/6-compassion.mp4" },
            { id: 7, title: "Generosity", description: "", url: "https://pub-71cfc9e8b30e46868845fef5a9b3555f.r2.dev/classes/SOL2/MODULE-3/7-generosity.mp4" },
            { id: 8, title: "Faith", description: "", url: "https://pub-71cfc9e8b30e46868845fef5a9b3555f.r2.dev/classes/SOL2/MODULE-3/8-faith.mp4" },
            { id: 9, title: "The cell vision", description: "", url: "https://pub-71cfc9e8b30e46868845fef5a9b3555f.r2.dev/classes/SOL2/MODULE-3/9-the-cell-vision.mp4" },
            { id: 10, title: "Structure and development", description: "", url: "https://pub-71cfc9e8b30e46868845fef5a9b3555f.r2.dev/classes/SOL2/MODULE-3/10-structure-and-development.mp4" }
        ],
        "MODULE 4": [
            { id: 1, title: "Families with a purpose", description: "", url: "https://pub-71cfc9e8b30e46868845fef5a9b3555f.r2.dev/classes/SOL2/MODULE-4/1-families-with-a-purpose.mp4" },
            { id: 2, title: "The roles of the parents and the children", description: "", url: "https://pub-71cfc9e8b30e46868845fef5a9b3555f.r2.dev/classes/SOL2/MODULE-4/2-the-roles-of-the-parents-and-the-children.mp4" },
            { id: 3, title: "Inner healing for the family", description: "", url: "https://pub-71cfc9e8b30e46868845fef5a9b3555f.r2.dev/classes/SOL2/MODULE-4/3-inner-healing-for-the-family.mp4" },
            { id: 4, title: "Seven pillars for a happy marriage", description: "", url: "https://pub-71cfc9e8b30e46868845fef5a9b3555f.r2.dev/classes/SOL2/MODULE-4/4-seven-pillars-for-a-happy-marriage.mp4" },
            { id: 5, title: "The blessing of fatherhood", description: "", url: "https://pub-71cfc9e8b30e46868845fef5a9b3555f.r2.dev/classes/SOL2/MODULE-4/5-the-blessing-of-fatherhood.mp4" },
            { id: 6, title: "Is this the right person", description: "", url: "https://pub-71cfc9e8b30e46868845fef5a9b3555f.r2.dev/classes/SOL2/MODULE-4/6-is-this-the-right-person.mp4" },
            { id: 7, title: "True love", description: "", url: "https://pub-71cfc9e8b30e46868845fef5a9b3555f.r2.dev/classes/SOL2/MODULE-4/7-true-love.mp4" },
            { id: 8, title: "Seven steps for a successful courtship", description: "", url: "https://pub-71cfc9e8b30e46868845fef5a9b3555f.r2.dev/classes/SOL2/MODULE-4/8-seven-steps-for-a-successful-courtship.mp4" },
            { id: 9, title: "Strengthening communication for marriage", description: "", url: "https://pub-71cfc9e8b30e46868845fef5a9b3555f.r2.dev/classes/SOL2/MODULE-4/9-strengthening-communication-for-marriage.mp4" },
            { id: 10, title: "Gods ten commandments for the family", description: "", url: "https://pub-71cfc9e8b30e46868845fef5a9b3555f.r2.dev/classes/SOL2/MODULE-4/10-gods-ten-commandments-for-the-family.mp4" }
        ]
    },
    "SOL 3": {
        "MODULE 5": [
            { id: 1, title: "A leader of faith", description: "", url: "https://drive.google.com/file/d/11F8EVW_cJuMwSs2HJWjAifo5QNypq-TD/view" },
            { id: 2, title: "The leaders love for the sheep", description: "", url: "https://drive.google.com/file/d/1no1S8Sbf0o75Vl3w21LhG6sWOgwkiAkm/view" },
            { id: 3, title: "A leader that builds", description: "", url: "https://drive.google.com/file/d/1P72XaB3AKU2nUVGTEoQCJJ5ef7MJ_knY/view" },
            { id: 4, title: "A leader with the heart of a servant", description: "", url: "https://drive.google.com/file/d/1Fdbcxanw4_UhM8DBtMdc_7q7obsC9MKl/view" },
            { id: 5, title: "The leader controlled by the Holy Spirit", description: "", url: "https://drive.google.com/file/d/1EaS0TtqygxCMuD1aK_Dx4zLGATr4LmMd/view" },
            { id: 6, title: "The leader preaching the word", description: "", url: "https://pub-71cfc9e8b30e46868845fef5a9b3555f.r2.dev/classes/SOL-3/MODULE-5/6-the-leader-preaching-the-word.mp4" },
            { id: 7, title: "The leader and counseling", description: "", url: "https://pub-71cfc9e8b30e46868845fef5a9b3555f.r2.dev/classes/SOL-3/MODULE-5/7-the-leader-and-counseling.mp4" },
            { id: 8, title: "The leader and supervision", description: "", url: "https://drive.google.com/file/d/1lBjmcOfgrd1AwOXiRRWAlrgd9XY3rFGH/view" },
            { id: 9, title: "The price of leadership", description: "", url: "https://drive.google.com/file/d/16DkCMR1P1wvwCClxk1hDECN5ZVZDBNCm/view" },
            { id: 10, title: "The leader and the formation of disciples", description: "", url: "https://drive.google.com/file/d/1-oM5sg98W4jnocxn9BpfHl4Hk7nvp7Tf/view" }
        ],
        "MODULE 6": [
            { id: 1, title: "The holy spirit and me", description: "", url: "https://drive.google.com/file/d/1_b7kavauUl_OCz7PX_PqW4s5OdmbsIAi/view" },
            { id: 2, title: "Preparing to receive the holy spirit", description: "", url: "https://drive.google.com/file/d/1NJjJ5bGAcIiOkZB5LMb8NMUolr0loaAw/view" },
            { id: 3, title: "Knowing the holy spirit", description: "", url: "https://drive.google.com/file/d/1woWgz_MQ5mC7pOawjENvqm1-lpNoqAhq/view" },
            { id: 4, title: "The fruit of the holy spirit", description: "", url: "https://drive.google.com/file/d/1idU0DuYToJI_RIw7zTgmheixayrdE700/view" },
            { id: 5, title: "The fruit of the holy spirit part 2", description: "", url: "https://drive.google.com/file/d/1HS0Ah5b5Gb2lNaROw15pwZQyMVcWz-hR/view" },
            { id: 6, title: "The fruit of the holy spirit part 3", description: "", url: "https://drive.google.com/file/d/1pESsJIQLdbSRrSBn2bS-bl98zYqzbGNn/view" },
            { id: 7, title: "Introduction of the gifts of the holy spirit", description: "", url: "https://drive.google.com/file/d/15k_NkX0bxgvmqnJWTJfc67ks6zdRl-Ki/view" },
            { id: 8, title: "Gifts of the revelation", description: "", url: "https://pub-71cfc9e8b30e46868845fef5a9b3555f.r2.dev/classes/SOL-3/MODULE-6/8-gifts-of-the-revelation.mp4" },
            { id: 9, title: "Gifts of power", description: "", url: "https://drive.google.com/file/d/1c7c9a94suLWy_lB9UTRGMgRIChdcowZ6/view" },
            { id: 10, title: "Gifts of inspiration", description: "", url: "" }
        ]
    }
};

// Helper function to convert video URLs to embeddable format
export function getEmbedUrl(url: string): string {
    if (!url) return '';

    // YouTube: Convert youtu.be or youtube.com/watch URLs to embed format
    // youtu.be/VIDEO_ID → youtube.com/embed/VIDEO_ID
    const youtubeShortMatch = url.match(/youtu\.be\/([a-zA-Z0-9_-]+)/);
    if (youtubeShortMatch) {
        return `https://www.youtube.com/embed/${youtubeShortMatch[1]}`;
    }

    // youtube.com/watch?v=VIDEO_ID → youtube.com/embed/VIDEO_ID
    const youtubeMatch = url.match(/youtube\.com\/watch\?v=([a-zA-Z0-9_-]+)/);
    if (youtubeMatch) {
        return `https://www.youtube.com/embed/${youtubeMatch[1]}`;
    }

    // Google Drive: Convert /view to /preview
    if (url.includes('drive.google.com')) {
        return url.replace('/view', '/preview').split('?')[0];
    }

    // Cloudflare Stream: Normalize to iframe embed
    if (url.includes('cloudflarestream.com') || url.includes('videodelivery.net')) {
        const cloudflareMatch = url.match(/(?:cloudflarestream\.com|videodelivery\.net)\/([a-zA-Z0-9_-]+)/);
        if (cloudflareMatch) {
            return `https://iframe.videodelivery.net/${cloudflareMatch[1]}`;
        }
    }

    return url;
}

export function getLessonCount(level: string): number {
    const levelData = curriculum[level as keyof typeof curriculum];
    if (!levelData) return 0;
    if (Array.isArray(levelData)) return levelData.length;
    return Object.values(levelData).reduce((sum, lessons) => sum + lessons.length, 0);
}

export function getYoutubeId(url: string): string | null {
    if (!url) return null;
    const shortMatch = url.match(/youtu\.be\/([a-zA-Z0-9_-]+)/);
    if (shortMatch) return shortMatch[1];
    const match = url.match(/youtube\.com\/watch\?v=([a-zA-Z0-9_-]+)/);
    if (match) return match[1];
    const embedMatch = url.match(/youtube\.com\/embed\/([a-zA-Z0-9_-]+)/);
    if (embedMatch) return embedMatch[1];
    return null;
}

export function getCloudflareId(url: string): string | null {
    if (!url) return null;
    const match = url.match(/(?:cloudflarestream\.com|videodelivery\.net)\/([a-zA-Z0-9_-]+)/);
    if (match) return match[1];
    return null;
}
